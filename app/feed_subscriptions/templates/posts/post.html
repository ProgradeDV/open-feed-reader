{% extends 'site_base/base.html' %}
{% load bleach_tags %}

{% block content %}
<div class="row">
  <div class="col-md-10 mx-auto">
    <div class="card">

      <div class="card-header">
        <div class="row">

          {% if post.image_url %}
          <div class="col-md-2 mx-auto">
            <img class="card-img-top" src="{{ post.image_url }}" alt="Card image cap">
          </div>
          {% endif %}

          <!-- title -->
          <div class="col-md-10 mx-auto">
            <div class="row">
              <h1>
                <a target="_blank" rel="noopener noreferrer" href="{{post.link}}">
                  {{ post.title }}
                </a>
              </h1>

            </div>

            <!-- credit -->
            <footer class="blockquote-footer mt-1">
              {% if post.author %}
              {{ post.author }} at 
              {% endif %}
              <a href="{% url 'one_source' id=post.source.id %}">{{ post.source.display_name }}</a>,
              {{ post.created }}
            </footer>
          </div>

        </div>
      </div>

      <div class="card-body">
        {% for enclosure in post.enclosures.all %}
          <div class="row p-2">
            {% if enclosure.type == 'youtube' %}
              {% include 'posts/enclosure_youtube.html' %}
            {% elif 'audio' in enclosure.type %}
              {% include 'posts/enclosure_audio.html' %}
            {% elif 'video' in enclosure.type %}
              {% include 'posts/enclosure_video.html' %}
            {% else %}
              Unknown Media: <a href="{{ enclosure.href }}">{{ enclosure.href }}</a>
            {% endif %}
          </div>
        {% endfor %}

        <div class="row p-2">
          {% if '<a' in post.body %}
            {{ post.body|bleach }}
          {% else %}
            {{ post.body|bleach|urlizetrunc:40|linebreaks }}
          {% endif %}
        </div>
      </div>

    </div>
  </div>
</div>
{% endblock %}
